@font-face {
    font-family: 'B Nazanin';
    src: url("../../fonts/B_NAZANIN/B-NAZANIN.TTF") format('truetype');
    font-weight: normal;
    font-style: normal;
  }
  
  /* Apply B Nazanin to all result sheet text with proper RTL rendering */
  #resultSheetContent * {
    font-family: 'B Nazanin', Tahoma, Arial, sans-serif !important;
    direction: rtl !important;
    unicode-bidi: embed !important;
    text-rendering: optimizeLegibility !important;
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
  }
  
  /* Specific fix for text elements to prevent character separation */
  #resultSheetContent h1,
  #resultSheetContent h2,
  #resultSheetContent h3,
  #resultSheetContent span,
  #resultSheetContent div,
  #resultSheetContent td,
  #resultSheetContent th {
    white-space: normal !important;
    word-spacing: normal !important;
    letter-spacing: normal !important;
  }

  @media print {
    @page { size: A4 portrait; margin: 0; }
    body { background: white; }
    .no-print { display: none !important; }
    body * { visibility: hidden !important; }
    #resultSheetContent, #resultSheetContent * { visibility: visible !important; }
    #resultSheetContent {
      position: absolute;
      left: 0;
      top: 0;
      width: 210mm;
      min-height: 297mm;
      height: 297mm;
      margin: 0;
      padding: 12mm;
      box-sizing: border-box;
      overflow: hidden;
      box-shadow: none !important;
      border: none !important;
    }
    .result-header { margin-bottom: 12px !important; padding-bottom: 12px !important; }
    .result-header h1 { font-size: 24px !important; }
    .result-header h2 { font-size: 20px !important; }
    .result-header h3 { font-size: 20px !important; margin-top: 6px !important; }
    .sheet-badge { font-size: 12px !important; padding: 2px 8px !important; }
    .info-panel { padding: 10px !important; margin-bottom: 12px !important; }
    .info-panel span { font-size: 14px !important; }
    .scores-table { margin-bottom: 12px !important; }
    .scores-table th,
    .scores-table td {
      padding: 6px 8px !important;
      font-size: 14px !important;
    }
    .scores-table.table-compact th,
    .scores-table.table-compact td {
      padding: 4px 6px !important;
      font-size: 13px !important;
    }
    .scores-table.table-compact-tight th,
    .scores-table.table-compact-tight td {
      padding: 3px 5px !important;
      font-size: 12px !important;
    }
    .scores-table.table-compact-tight .table-head th { font-size: 12px !important; }
    .summary-section { margin-bottom: 12px !important; }
    .summary-card,
    .status-card { padding: 10px !important; }
    .summary-card h4,
    .status-card h4 { font-size: 16px !important; margin-bottom: 6px !important; }
    .summary-card span { font-size: 14px !important; }
    .status-value { font-size: 32px !important; }
    .footer-signatures { margin-top: 12px !important; padding-top: 12px !important; gap: 16px !important; }
    .footer-signatures .h-16 { height: 40px !important; }
    .signature-title { font-size: 14px !important; }
    #resultSheetContent { page-break-inside: avoid; }
  }

  .result-sheet {
    --accent-strong: #1e40af;
    --accent: #3b82f6;
    --accent-soft: #dbeafe;
    --accent-border: #93c5fd;
    --accent-text: #1e3a8a;
    --header-gradient: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
    --sheet-soft: #f8fafc;
  }
  .result-sheet.sheet-moteseta {
    --accent-strong: #166534;
    --accent: #22c55e;
    --accent-soft: #dcfce7;
    --accent-border: #86efac;
    --accent-text: #14532d;
    --header-gradient: linear-gradient(135deg, #166534 0%, #22c55e 100%);
    --sheet-soft: #f0fdf4;
  }
  .result-sheet.sheet-ebtedai {
    --accent-strong: #92400e;
    --accent: #f59e0b;
    --accent-soft: #fef3c7;
    --accent-border: #fcd34d;
    --accent-text: #78350f;
    --header-gradient: linear-gradient(135deg, #b45309 0%, #f59e0b 100%);
    --sheet-soft: #fffbeb;
  }
  .result-sheet .result-header {
    border-color: var(--accent-strong);
  }
  .result-sheet .result-title {
    color: var(--accent-text);
  }
  .result-sheet .sheet-badge {
    background: var(--accent-soft);
    color: var(--accent-text);
    border: 1px solid var(--accent-border);
  }
  .result-sheet .info-panel {
    background: var(--sheet-soft);
    border: 1px solid var(--accent-border);
  }
  .result-sheet .info-card {
    background: var(--accent-soft);
    border-color: var(--accent-border);
  }
  .result-sheet .table-head {
    background: var(--header-gradient);
  }
